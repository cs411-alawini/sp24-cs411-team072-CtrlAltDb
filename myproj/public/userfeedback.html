<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit Course Review</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: #f9f9f9;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        header {
            background-color: #13294b;
            color: white;
            padding: 1em;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        nav ul {
            list-style: none;
            padding: 0;
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        nav ul li {
            margin-right: 20px;
        }
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: bold;
        }
        main {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        form {
            background: white;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #333;
        }
        input[type="text"], input[type="number"], input[type="email"], textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            width: 100%;
            padding: 10px;
            background-color: #13294b;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background-color: #0b1c2c;
        }
        footer {
            background-color: #13294b;
            color: white;
            text-align: center;
            padding: 10px 0;
            width: 100%;
        }
        .response-output {
            width: 90%;
            max-width: 500px;
            margin: 20px auto;
            padding: 20px;
            background: #e0e0e0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <header>
        
        <h1>Course Reviews</h1>
    </header>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="login-register.html">Login/Register</a></li>
            <li><a href="profile.html">Profile</a></li>
            <li><a href="about.html">About</a></li>
        </ul>
    </nav>
    <main>
        <form id="reviewForm">
            <div class="form-group">
                <label for="email">University Email:</label>
                <input type="email" id="email" name="email" placeholder="netid@illinois.edu" required>
            </div>
            <div class="form-group">
                <label for="crn">Course CRN:</label>
                <input type="number" id="crn" name="crn" placeholder="Course CRN" required>
            </div>
            <div class="form-group">
                <label for="year">Year:</label>
                <input type="number" id="year" name="year" placeholder="Year taken" required>
            </div>
            <div class="form-group">
                <label for="semester">Semester:</label>
                <input type="text" id="semester" name="semester" placeholder="Semester (e.g., Fall 2024)" required>
            </div>
            <div class="form-group">
                <label for="testimony">Testimony:</label>
                <textarea id="testimony" name="testimony" rows="4" placeholder="Write your review here..."></textarea>
            </div>
            <div class="form-group">
                <label for="rating">Rating (1.0 - 10.0):</label>
                <input type="number" id="rating" name="rating" step="0.1" min="1" max="10" placeholder="Rate the course">
            </div>
            <div class="form-group">
                <label for="difficulty">Difficulty (1.0 - 10.0):</label>
                <input type="number" id="difficulty" name="difficulty" step="0.1" min="1" max="10" placeholder="Difficulty level">
            </div>
            <div class="form-group">
                <label for="timeCommit">Time Commitment (hours per week):</label>
                <input type="number" id="timeCommit" name="timeCommit" min="1" max="40" step="0.1" placeholder="Time spent per week">
            </div>
            <button type="button" id="submitReview">Submit Review</button>
            <button type="button" id="deleteReview">Delete Review</button>
            <button type="button" id="updateReview"> Update Review</button>
        </form>
        <!-- Response Output Area -->
        <div class="response-output" id="responseOutput"></div>
    </main>
    <footer>
        <p>&copy; 2024 Course Investigator. All rights reserved.</p>
    </footer>
    <script>
        document.getElementById('submitReview').addEventListener('click', function(event) {
            event.preventDefault();
            const formData = {
                email: document.getElementById('email').value,
                crn: document.getElementById('crn').value,
                year: document.getElementById('year').value,
                semester: document.getElementById('semester').value,
                testimony: document.getElementById('testimony').value,
                rating: document.getElementById('rating').value,
                difficulty: document.getElementById('difficulty').value,
                timeCommit: document.getElementById('timeCommit').value
            };
        
            // Call your API endpoint with form data
            fetch('/submitReview', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                const reviewData = data.data;
                // Process and display the data
                const outputDiv = document.getElementById('responseOutput');
                outputDiv.innerHTML = '';
                const dataDiv = document.createElement('div');
                dataDiv.innerHTML = `<strong>Review Submitted:</strong> <br>Email: ${reviewData.email}<br>CRN: ${reviewData.crn}<br>Year: ${reviewData.year}<br>Semester: ${reviewData.semester}<br>Testimony: ${reviewData.testimony}<br>Rating: ${reviewData.rating}<br>Difficulty: ${reviewData.difficulty}<br>Time Commitment: ${reviewData.timeCommit} hours/week<br>`;
                outputDiv.appendChild(dataDiv);
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('responseOutput').innerHTML = 'Failed to submit review.';
            });

            // Clear form fields after submission
            //document.getElementById('reviewForm').reset();
        });


        document.getElementById('deleteReview').addEventListener('click', function(event) {
            event.preventDefault();
            const deleteFormData = {
                email: document.getElementById('email').value,
                crn: document.getElementById('crn').value,
                year: document.getElementById('year').value,
                semester: document.getElementById('semester').value,
            };
            const url = `/deleteReview?email=${deleteFormData.email}&crn=${deleteFormData.crn}&year=${deleteFormData.year}&semester=${deleteFormData.semester}`;
            fetch(url, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json',
                }
                //body: JSON.stringify(deleteFormData)
            })
            .then(response => response.json())
            .then(data => {
                const outputDiv = document.getElementById('responseOutput');
                outputDiv.innerHTML = '';
                console.log('Review deleted', data);
                outputDiv.innerHTML = 'Review deleted successfully.';
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('responseOutput').innerHTML = 'Failed to delete review';
            });

        });

        document.getElementById('updateReview').addEventListener('click', function(event) {
            event.preventDefault();
            const updateFormData = {
                email: document.getElementById('email').value,
                crn: document.getElementById('crn').value,
                year: document.getElementById('year').value,
                semester: document.getElementById('semester').value,
                testimony: document.getElementById('testimony').value,
                rating: document.getElementById('rating').value,
                difficulty: document.getElementById('difficulty').value,
                timeCommit: document.getElementById('timeCommit').value
            };
        
            // Call your API endpoint with form data
            fetch('/updateReview', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(updateFormData)
            })
            .then(response => response.json())
            .then(data => {
                const reviewData = data.data;
                // Process and display the data
                const outputDiv = document.getElementById('responseOutput');
                outputDiv.innerHTML = '';
                const dataDiv = document.createElement('div');
                dataDiv.innerHTML = `<strong>Review Edited:</strong> <br>Email: ${reviewData.email}<br>CRN: ${reviewData.crn}<br>Year: ${reviewData.year}<br>Semester: ${reviewData.semester}<br>Testimony: ${reviewData.testimony}<br>Rating: ${reviewData.rating}<br>Difficulty: ${reviewData.difficulty}<br>Time Commitment: ${reviewData.timeCommit} hours/week<br>`;
                outputDiv.appendChild(dataDiv);
            })
            .catch(error => {
                console.error('Error:', error);
                document.getElementById('responseOutput').innerHTML = 'Failed to edit review.';
            });

            // Clear form fields after submission
            //document.getElementById('reviewForm').reset();
        });
        
        
    </script>
</body>
</html>
